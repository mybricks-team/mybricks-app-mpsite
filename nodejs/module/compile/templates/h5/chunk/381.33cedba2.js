"use strict";(self.webpackJsonp=self.webpackJsonp||[]).push([[381],{"4056":function(e,n,r){r.d(n,{"y":function(){return polyfillCoreComlib}});var o=r(2735);function Selection(){return o.createElement("view",{"style":{"width":"100%","height":"100%"}})}function Group(e){var n=e.slots;return o.createElement("view",{"style":{"width":"100%","height":"100%","overflow":"visible"}},n.content.render())}function polyfillCoreComlib(e){return e["mybricks.core-comlib.selection-1.0.0"]||(e["mybricks.core-comlib.selection-1.0.0"]={"namespace":"mybricks.core-comlib.selection","version":"1.0.0","runtime":Selection}),e["mybricks.core-comlib.group-1.0.0"]||(e["mybricks.core-comlib.group-1.0.0"]={"namespace":"mybricks.core-comlib.group","version":"1.0.0","runtime":Group}),e}},"2239":function(e,n,r){r.a(e,(async function(e,o){try{var t=r(4565),i=e([t]);t=(i.then?(await i)():i)[0];var a=r.n(t);n.Z=a(),o()}catch(e){o(e)}}))},"4054":function(e,n){n.Z={}},"7381":function(e,n,r){r.a(e,(async function(e,o){try{r.r(n);var t=r(1096),i=r(2577),a=r(2735),c=r(6984),s=r(3527),u=r(3358),l=r(7273),f=r(4054),p=r(2239),d=r(789),m=r(4056),v=(r(5013),r(4680)),g=r.n(v),h=r(935),y=r.n(h),b=e([p]);p=(b.then?(await b)():b)[0];var S=["stamp","$taroTimestamp"],Z=(0,d.rC)(),O={"message":null,"timeline":null},w=function setShareConfig(e,n){O[e]=n};function fixRouterParams(e){if(!e)return e;e.stamp,e.$taroTimestamp;var n=(0,t.Z)(e,S);console.log("[newParams]",JSON.parse(JSON.stringify(n)));var r=parseEncodedObject(n);return console.log("[result]",JSON.parse(JSON.stringify(r))),r}function parseEncodedObject(e){var n={};for(var r in e)if(e.hasOwnProperty(r)){var o=void 0;try{o=decodeURIComponent(e[r])}catch(e){}try{var t=JSON.parse(o);"number"==typeof t||(o=t)}catch(e){}n[r]=o}return n}function safaParse(e){var n=e;try{n=JSON.stringify(e)}catch(e){}return n}n.default=function(){var e,n,r,o,t,d,v=(0,a.useState)(!1),h=(0,i.Z)(v,2),b=h[0],S=h[1],P=(0,a.useState)((0,c.FN)().router),C=(0,i.Z)(P,1)[0],J=(0,a.useRef)(null),k=(0,a.useRef)(!1),N=C.path.split("/").reverse()[1];r=null===(t=g()[N])||void 0===t?void 0:t.pageToJson,o=null===(d=g()[N])||void 0===d?void 0:d.pageConfig,(0,a.useEffect)((function(){return(0,s.Gr)((function(e){u.td.trigger("onKeyboardHeightChange",e)})),function(){(0,s.g7)()}}),[]),u.ZP.useLoad((function(){console.log("comDefs",p.Z),Z.h.render(JSON.parse(y()).pageOnLoad,{"comDefs":(0,m.y)(p.Z),"comInstance":f.Z,"ref":function ref(e){e.outputs("next",(function(e){console.log("next",e),S(!0)})),e.inputs.onLoad({"id":"","path":"","query":{}}),e.run()},"setShareConfig":w})})),u.ZP.useDidShow((function(){var e;null!==(e=o)&&void 0!==e&&e.navigationBarTitleText&&(0,l.ZT)({"title":o.navigationBarTitleText}),k.current?u.td.trigger("pageDidShow",{"path":C.path||"","query":fixRouterParams(C.params||{})}):k.current=!0})),u.ZP.useDidHide((function(){(0,l.ZT)({"title":" "}),u.td.trigger("pageDidHide",{"path":C.path||"","query":fixRouterParams(C.params||{})})})),u.ZP.useUnload((function(){var e,n;null===(e=(n=Z.h).destroy)||void 0===e||e.call(n,N)})),u.ZP.useShareAppMessage((function(){if(O.message)return O.message})),u.ZP.useShareTimeline((function(){if(O.timeline)return O.timeline}));var x=Z.h.render(r,{"comDefs":(0,m.y)(p.Z),"comInstance":f.Z,"ref":function ref(e){if(!J.current){J.current=e;try{var n,r,o,t=(null===(n=(0,c.FN)())||void 0===n||null===(n=n.router)||void 0===n?void 0:n.params)||{};if(t.params)try{var i=decodeURIComponent(t.params);"string"==typeof i&&0===i.indexOf("{")&&i.indexOf("}")===i.length-1&&(t=JSON.parse(i))}catch(e){}var a=fixRouterParams(t);console.log("%c [render-mpsite] %c 页面打开 ".concat(N," | open -> ").concat(safaParse(a)),"color:white;background-color:green","color:white;background-color:black"),null==e||null===(r=(o=e.inputs).open)||void 0===r||r.call(o,a)}catch(n){var s,u;console.error("open",n),null==e||null===(s=(u=e.inputs).open)||void 0===s||s.call(u,{})}}},"setShareConfig":w});return null!==(n=(((null===(e=JSON.parse(y()||"{}"))||void 0===e?void 0:e.pageOnLoad)||{}).cons||{})["_rootFrame_-onLoad"])&&void 0!==n&&n.length&&!b?null:x},o()}catch(P){o(P)}}))}}]);